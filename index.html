<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Mini Minecraft 3D – Mobile Style</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
body{margin:0;overflow:hidden;background:black;font-family:Arial}
canvas{display:block}
/* Joystick */
#joystick{
  position:fixed;left:20px;bottom:40px;width:120px;height:120px;
  background:rgba(255,255,255,0.15);border-radius:50%;
}
#stick{
  position:absolute;left:40px;top:40px;width:40px;height:40px;
  background:rgba(255,255,255,0.6);border-radius:50%;
}
#jump{
  position:fixed;right:30px;bottom:70px;width:70px;height:70px;
  border-radius:50%;border:none;font-size:28px;
  background:rgba(255,255,255,0.7);
}
/* Hotbar */
#hotbar{
  position:fixed;bottom:10px;left:50%;transform:translateX(-50%);
  display:flex;gap:6px
}
.slot{
  width:42px;height:42px;border:2px solid rgba(255,255,255,0.6);
  background:rgba(0,0,0,0.4)
}
.selected{border:3px solid white}
</style>
</head>
<body>
<div id="joystick"><div id="stick"></div></div>
<button id="jump">⤒</button>
<div id="hotbar">
  <div class="slot selected" data-type="grass" style="background:#4CAF50"></div>
  <div class="slot" data-type="stone" style="background:#9E9E9E"></div>
  <div class="slot" data-type="wood" style="background:#795548"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script>
// Scene
const scene=new THREE.Scene();scene.background=new THREE.Color(0x87ceeb);
const camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);document.body.appendChild(renderer.domElement);
scene.add(new THREE.AmbientLight(0xffffff,0.7));
const sun=new THREE.DirectionalLight(0xffffff,0.6);sun.position.set(10,20,10);scene.add(sun);

// Blocks
const geo=new THREE.BoxGeometry(1,1,1);
const mats={
 grass:new THREE.MeshLambertMaterial({color:0x4CAF50}),
 stone:new THREE.MeshLambertMaterial({color:0x9E9E9E}),
 wood:new THREE.MeshLambertMaterial({color:0x795548})
};
const blocks={};
const key=(x,y,z)=>`${x},${y},${z}`;
function addBlock(x,y,z,type){
 if(blocks[key(x,y,z)])return;
 const m=new THREE.Mesh(geo,mats[type]);m.position.set(x,y,z);
 scene.add(m);blocks[key(x,y,z)]=m;
}
function removeBlock(x,y,z){const k=key(x,y,z);if(blocks[k]){scene.remove(blocks[k]);delete blocks[k];}}

for(let x=-10;x<=10;x++)for(let z=-10;z<=10;z++)addBlock(x,0,z,'grass');

// Player
const player={pos:new THREE.Vector3(0,2,5),vel:new THREE.Vector3(),onGround:false};
let move={x:0,z:0};let currentBlock='grass';

// Joystick logic
const joy=document.getElementById('joystick');const stick=document.getElementById('stick');
let joyActive=false;
joy.addEventListener('touchstart',()=>joyActive=true);
joy.addEventListener('touchend',()=>{joyActive=false;move={x:0,z:0};stick.style.left='40px';stick.style.top='40px'});
joy.addEventListener('touchmove',e=>{
 const r=joy.getBoundingClientRect();const t=e.touches[0];
 let dx=t.clientX-(r.left+r.width/2);
 let dy=t.clientY-(r.top+r.height/2);
 const max=40;dx=Math.max(-max,Math.min(max,dx));dy=Math.max(-max,Math.min(max,dy));
 stick.style.left=40+dx+'px';stick.style.top=40+dy+'px';
 move.x=dx/max;move.z=dy/max;
});

// Jump
document.getElementById('jump').ontouchstart=()=>{if(player.onGround){player.vel.y=0.25;player.onGround=false}};

// Hotbar
document.querySelectorAll('.slot').forEach(s=>{
 s.onclick=()=>{
  document.querySelectorAll('.slot').forEach(x=>x.classList.remove('selected'));
  s.classList.add('selected');currentBlock=s.dataset.type;
 }
});

// Place / break
const ray=new THREE.Raycaster();
window.addEventListener('touchend',e=>{
 ray.setFromCamera({x:0,y:0},camera);
 const hit=ray.intersectObjects(Object.values(blocks));
 if(hit.length){const p=hit[0].object.position;addBlock(p.x,p.y+1,p.z,currentBlock)}
});

function update(){
 player.vel.x=move.x*0.1;player.vel.z=move.z*0.1;
 player.vel.y-=0.01;player.pos.add(player.vel);
 if(player.pos.y<1.8){player.pos.y=1.8;player.vel.y=0;player.onGround=true}
 camera.position.copy(player.pos);
}
function loop(){update();renderer.render(scene,camera);requestAnimationFrame(loop)}
loop();

onresize=()=>{camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();renderer.setSize(innerWidth,innerHeight)};
</script>
</body>
</html>

