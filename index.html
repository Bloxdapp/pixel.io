<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Mini Minecraft 3D â€“ Vrai 3D</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
body{margin:0;overflow:hidden;background:black}
#ui{position:fixed;bottom:10px;left:50%;transform:translateX(-50%);display:flex;gap:8px;z-index:10}
#ui button{padding:12px 16px;font-size:16px;border:none;border-radius:8px;opacity:0.85}
#hint{position:fixed;top:10px;left:50%;transform:translateX(-50%);color:white;font-family:Arial}
</style>
</head>
<body>
<div id="hint">ðŸ“± Mobile : boutons | ðŸ‘† Tap = placer | Appui long = casser</div>
<div id="ui">
  <button id="left">â—€</button>
  <button id="right">â–¶</button>
  <button id="forward">â–²</button>
  <button id="back">â–¼</button>
  <button id="jump">â¤’</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script>
// SCÃˆNE
const scene=new THREE.Scene();
scene.background=new THREE.Color(0x87ceeb);

// CAMÃ‰RA (vue Minecraft)
const camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
camera.position.set(0,2,5);

// RENDERER
const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth,window.innerHeight);
document.body.appendChild(renderer.domElement);

// LUMIÃˆRE
scene.add(new THREE.AmbientLight(0xffffff,0.6));
const sun=new THREE.DirectionalLight(0xffffff,0.6);
sun.position.set(10,20,10);
scene.add(sun);

// BLOCS
const blockSize=1;
const blocks={};
const geometries={
  grass:new THREE.BoxGeometry(1,1,1),
};
const materials={
  grass:new THREE.MeshLambertMaterial({color:0x4CAF50})
};

function key(x,y,z){return `${x},${y},${z}`}

function addBlock(x,y,z,type='grass'){
  const mesh=new THREE.Mesh(geometries[type],materials[type]);
  mesh.position.set(x,y,z);
  scene.add(mesh);
  blocks[key(x,y,z)]=mesh;
}

function removeBlock(x,y,z){
  const k=key(x,y,z);
  if(blocks[k]){
    scene.remove(blocks[k]);
    delete blocks[k];
  }
}

// SOL
for(let x=-10;x<=10;x++){
  for(let z=-10;z<=10;z++){
    addBlock(x,0,z);
  }
}

// JOUEUR
const player={pos:new THREE.Vector3(0,2,5),vel:new THREE.Vector3(),onGround:false};
const speed=0.08;
const gravity=0.01;

// CONTRÃ”LES
const keys={};
function bind(id,key){
  const b=document.getElementById(id);
  b.ontouchstart=()=>keys[key]=true;
  b.ontouchend=()=>keys[key]=false;
}
bind('left','a');bind('right','d');bind('forward','w');bind('back','s');bind('jump',' ');

// RAYCAST (placer / casser)
const raycaster=new THREE.Raycaster();
const touch=new THREE.Vector2();
let pressTime=0;

window.addEventListener('touchstart',e=>{
  pressTime=Date.now();
});

window.addEventListener('touchend',e=>{
  touch.x=0; touch.y=0;
  raycaster.setFromCamera(touch,camera);
  const hits=raycaster.intersectObjects(Object.values(blocks));
  if(hits.length){
    const p=hits[0].object.position;
    if(Date.now()-pressTime>400){
      removeBlock(p.x,p.y,p.z);
    }else{
      addBlock(p.x,p.y+1,p.z);
    }
  }
});

function update(){
  if(keys['w']) player.vel.z=-speed;
  if(keys['s']) player.vel.z=speed;
  if(keys['a']) player.vel.x=-speed;
  if(keys['d']) player.vel.x=speed;

  player.vel.y-=gravity;

  if(keys[' ']&&player.onGround){
    player.vel.y=0.25;
    player.onGround=false;
  }

  player.pos.add(player.vel);

  // sol collision simple
  if(player.pos.y<1.8){player.pos.y=1.8;player.vel.y=0;player.onGround=true}

  player.vel.multiplyScalar(0.9);
  camera.position.copy(player.pos);
}

function loop(){update();renderer.render(scene,camera);requestAnimationFrame(loop)}
loop();

window.onresize=()=>{
  camera.aspect=window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
}
</script>
</body>
</html>

